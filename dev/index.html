<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ReactionNetworkImporters.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/ReactionNetworkImporters/stable/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ReactionNetworkImporters.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/ReactionNetworkImporters.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ReactionNetworkImporters.jl"><a class="docs-heading-anchor" href="#ReactionNetworkImporters.jl">ReactionNetworkImporters.jl</a><a id="ReactionNetworkImporters.jl-1"></a><a class="docs-heading-anchor-permalink" href="#ReactionNetworkImporters.jl" title="Permalink"></a></h1><p>This package provides importers to load reaction networks into <a href="https://docs.sciml.ai/Catalyst/stable/">Catalyst.jl</a> <a href="https://docs.sciml.ai/Catalyst/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code>s</a> from several file formats. Currently it supports loading networks in the following formats:</p><ol><li>A <em>subset</em> of the BioNetGen .net file format.</li><li>Networks represented by dense or sparse substrate and product stoichiometric matrices.</li><li>Networks represented by dense or sparse complex stoichiometric and incidence matrices.</li></ol><p><a href="https://docs.sciml.ai/SBMLToolkit/stable/">SBMLToolkit.jl</a> provides an alternative for loading SBML files into Catalyst models, offering a much broader set of supported features. It allows the import of models that include features such as constant species, boundary condition species, events, constraint equations and more. SBML files can be generated from many standard modeling tools, including BioNetGen, COPASI, and Virtual Cell.</p><hr/><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="Loading-a-BioNetGen-.net-file"><a class="docs-heading-anchor" href="#Loading-a-BioNetGen-.net-file">Loading a BioNetGen .net file</a><a id="Loading-a-BioNetGen-.net-file-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-a-BioNetGen-.net-file" title="Permalink"></a></h3><p>A simple network from the builtin BioNetGen bngl examples is the <a href="https://github.com/SciML/ReactionNetworkImporters.jl/blob/65f5f23bc52a7eefe32ca2ccabef0298e8e5772d/data/repressilator/Repressilator.bngl">repressilator</a>. The <code>generate_network</code> command in the bngl file outputs a reduced network description, i.e. a <a href="https://github.com/SciML/ReactionNetworkImporters.jl/blob/65f5f23bc52a7eefe32ca2ccabef0298e8e5772d/data/repressilator/Repressilator.net">.net</a> file, which can be loaded into a Catalyst <code>ReactionSystem</code> as:</p><pre><code class="language-julia hljs">using ReactionNetworkImporters
fname = &quot;PATH/TO/Repressilator.net&quot;
prnbng = loadrxnetwork(BNGNetwork(), fname)</code></pre><p>Here <code>BNGNetwork</code> is a type specifying the file format that is being loaded. <code>prnbng</code> is a <code>ParsedReactionNetwork</code> structure with the following fields:</p><ul><li><code>rn</code>, a Catalyst <code>ReactionSystem</code></li><li><code>u₀</code>, a <code>Dict</code> mapping initial condition symbolic variables to numeric values and/or symbolic expressions.</li><li><code>p</code>, a <code>Dict</code> mapping parameter symbolic variables to numeric values and/or symbolic expressions.</li><li><code>varstonames</code>, a <code>Dict</code> mapping the internal symbolic variable of a species used in the generated <code>ReactionSystem</code> to a <code>String</code> generated from the name in the .net file. This is necessary as BioNetGen can generate exceptionally long species names, involving characters that lead to malformed species names when used with <code>Catalyst</code>.</li><li><code>groupstosyms</code>, a <code>Dict</code> mapping the <code>String</code>s representing names for any groups defined in the BioNetGen file to the corresponding symbolic variable representing the <code>ModelingToolkit</code> symbolic observable associated with the group.</li></ul><p>Given <code>prnbng</code>, we can construct and solve the corresponding ODE model for the reaction system by</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, Catalyst
rn = prnbng.rn
tf = 100000.0
oprob = ODEProblem(rn, Float64[], (0.,tf), Float64[])
sol = solve(oprob, Tsit5(), saveat=tf/1000.)</code></pre><p>Note that we specify empty parameter and initial condition vectors as these are already stored in the generated <code>ReactionSystem</code>, <code>rn</code>. A <code>Dict</code> mapping each symbolic species and parameter to its initial value or symbolic expression can be obtained using <code>ModelingToolkit.defaults(rn)</code>.</p><p>See the <a href="https://docs.sciml.ai/Catalyst/stable/">Catalyst documentation</a> for how to generate ODE, SDE, jump and other types of models.</p><h3 id="Loading-a-matrix-representation"><a class="docs-heading-anchor" href="#Loading-a-matrix-representation">Loading a matrix representation</a><a id="Loading-a-matrix-representation-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-a-matrix-representation" title="Permalink"></a></h3><p>Catalyst <code>ReactionSystem</code>s can also be constructed from</p><ul><li>substrate and product stoichiometric matrices.</li><li>complex stoichiometric and incidence matrices.</li></ul><p>For example, here we both directly build a Catalyst network using the <code>@reaction_network</code> macro, and then show how to build the same network from these matrices using <code>ReactionNetworkImporters</code>:</p><pre><code class="language-julia hljs"># Catalyst network from the macro:
rs = @reaction_network begin
    k1, 2A --&gt; B
    k2, B --&gt; 2A
    k3, A + B --&gt; C
    k4, C --&gt; A + B
    k5, 3C --&gt; 3A
end k1 k2 k3 k4 k5

# network from basic stoichiometry using ReactionNetworkImporters
@parameters k1 k2 k3 k4 k5
@variables t A(t) B(t) C(t)
species = [A,B,C]
pars = [k1,k2,k3,k4,k5]
substoich =[ 2  0  1  0  0;
            0  1  1  0  0;
            0  0  0  1  3]
prodstoich =  [0  2  0  1  3;
                1  0  0  1  0;
                0  0  1  0  0]
mn= MatrixNetwork(pars, substoich, prodstoich; species=species,
                  params=pars) # a matrix network
prn = loadrxnetwork(mn) # dense version

# test the two networks are the same
@assert rs == prn.rn

# network from reaction complex stoichiometry
stoichmat =[2  0  1  0  0  3;
                 0  1  1  0  0  0;
                 0  0  0  1  3  0]
incidencemat  = [-1   1   0   0   0;
                 1  -1   0   0   0;
                 0   0  -1   1   0;
                 0   0   1  -1   0;
                 0   0   0   0  -1;
                 0   0   0   0   1]
cmn= ComplexMatrixNetwork(pars, stoichmat, incidencemat; species=species,
                          params=pars)  # a complex matrix network
prn = loadrxnetwork(cmn)

# test the two networks are the same
@assert rs == prn.rn</code></pre><p>The basic usages are</p><pre><code class="language-julia hljs">mn = MatrixNetwork(rateexprs, substoich, prodstoich; species=Any[],
                   params=Any[], t=nothing)
prn = loadrxnetwork(mn::MatrixNetwork)

cmn = ComplexMatrixNetwork(rateexprs, stoichmat, incidencemat; species=Any[],
                           params=Any[], t=nothing)
prn = loadrxnetwork(cmn::ComplexMatrixNetwork)</code></pre><p>Here <code>MatrixNetwork</code> and <code>ComplexMatrixNetwork</code> are the types, which select that we are constructing a substrate/product stoichiometric matrix-based or a reaction complex matrix-based stoichiometric representation as input. See the <a href="https://docs.sciml.ai/Catalyst/stable/api/catalyst_api/">Catalyst.jl API</a> for more discussion on these matrix representations, and how Catalyst handles symbolic reaction rate expressions. These two types have the following fields:</p><ul><li><code>rateexprs</code>, any valid <a href="https://docs.sciml.ai/Symbolics/stable/">Symbolics.jl</a> expression for the rates, or any basic number type. This can be a hardcoded rate constant like <code>1.0</code>, a parameter like <code>k1</code> above, or an general Symbolics expression involving parameters and species like <code>k*A</code>.</li><li>matrix inputs<ul><li>For <code>MatrixNetwork</code><ul><li><code>substoich</code>, a number of species by number of reactions matrix with entry <code>(i,j)</code> giving the stoichiometric coefficient of species <code>i</code> as a substrate in reaction <code>j</code>.</li><li><code>prodstoich</code>, a number of species by number of reactions matrix with entry <code>(i,j)</code> giving the stoichiometric coefficient of species <code>i</code> as a product in reaction <code>j</code>.</li></ul></li><li>For <code>ComplexMatrixNetwork</code><ul><li><code>stoichmat</code>, the complex stoichiometry matrix <a href="https://docs.sciml.ai/Catalyst/stable/api/catalyst_api/#Catalyst.complexstoichmat">defined here</a>.</li><li><code>incidencemat</code>, the complex incidence matrix <a href="https://docs.sciml.ai/Catalyst/stable/api/catalyst_api/#Catalyst.reactioncomplexes">defined here</a>.</li></ul></li></ul></li><li><code>species</code>, an optional vector of symbolic variables representing each species in the network. Can be constructed using the Symbolics.jl <code>@variables</code> macro. Each species should be dependent on the same time variable (<code>t</code> in the example above).</li><li><code>parameters</code>, a vector of symbolic variables representing each parameter in the network. Can be constructed with the <a href="https://docs.sciml.ai/ModelingToolkit/stable/">ModelingToolkit.jl</a> <code>@parameters</code> macro. If no parameters are used it is an optional keyword.</li><li><code>t</code>, an optional Symbolics.jl variable representing time as the independent variable of the reaction network. If not provided <code>Catalyst.DEFAULT_IV</code> is used to determine the default time variable.</li></ul><p>For both input types, <code>loadrxnetwork</code> returns a <code>ParsedReactionNetwork</code>, <code>prn</code>, with only the field, <code>prn.rn</code>, filled in. <code>prn.rn</code> corresponds to the generated <a href="https://docs.sciml.ai/Catalyst/stable/api/catalyst_api/#Catalyst.ReactionSystem">Catalyst.jl <code>ReactionSystem</code></a> that represents the network.</p><p>Dispatches are added if <code>substoich</code> and <code>prodstoich</code> both have the type <code>SparseMatrixCSC</code>in case of <code>MatrixNetwork</code> (or <code>stoichmat</code> and <code>incidencemat</code> both have the type <code>SparseMatrixCSC</code> in case of <code>ComplexMatrixNetwork</code>), in which case they are efficiently iterated through using the <code>SparseArrays</code> interface.</p><p>If the keyword argument <code>species</code> is not set, the resulting reaction network will simply name the species <code>S1</code>, <code>S2</code>,..., <code>SN</code> for a system with <code>N</code> total species. <code>params</code> defaults to an empty vector, so that it does not need to be set for systems with no parameters.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 23 October 2022 23:21">Sunday 23 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
